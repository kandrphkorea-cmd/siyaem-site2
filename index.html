<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SiyaEm Korea ‚Äî –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –º–µ—Å—Ç–∞</title>
<meta name="description" content="–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –≤ –ö–æ—Ä–µ–µ: –µ–¥–∞, —Å–∞–ª–æ–Ω—ã, –∞–≤—Ç–æ-—Å–µ—Ä–≤–∏—Å—ã, —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è. –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∏ –ª–∏—Ü–µ–Ω–∑–∏–∏. –†–µ–π—Ç–∏–Ω–≥, –æ—Ç–∑—ã–≤—ã, –∫–æ–Ω—Ç–∞–∫—Ç—ã.">
<style>
  :root{
    --bg: #0f1629;          /* —Ç—ë–º–Ω—ã–π —Ñ–æ–Ω (–º—è–≥–∫–∏–π navy) */
    --bg-2:#101827;         /* –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç—ë–º–Ω–∞—è */
    --text:#e7ecf5;
    --muted:#9fb1cc;
    --card:#111c2d;
    --line:#22324b;
    --acc:#4f8cff;          /* –∞–∫—Ü–µ–Ω—Ç —Å–∏–Ω–∏–π, –º—è–≥–∫–∏–π */
    --acc-2:#ffd266;        /* –∞–∫—Ü–µ–Ω—Ç —Ç—ë–ø–ª—ã–π */
    --good:#10b981;
    --bad:#ef4444;
    --ring: 24px;
    --radius:16px;
    --shadow: 0 8px 26px rgba(0,0,0,.25);
  }
  [data-theme="light"]{
    --bg:#f7f9fc;
    --bg-2:#fff;
    --card:#fff;
    --text:#0b1a2c;
    --muted:#5b6f87;
    --line:#e7edf5;
    --acc:#3c74ff;
    --acc-2:#ffb400;
    --shadow: 0 10px 22px rgba(13,36,65,.10);
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    background:
      radial-gradient(1200px 600px at 50% -200px, rgba(79,140,255,.18), transparent 60%),
      var(--bg);
    color:var(--text);
    font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  }
  .wrap{max-width:1100px;margin:0 auto;padding:20px}
  header{
    position:sticky;top:0;z-index:30;
    backdrop-filter: blur(10px);
    background: color-mix(in hsl, var(--bg) 82%, transparent);
    border-bottom:1px solid var(--line);
  }
  .nav{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:12px 0}
  .brand{display:flex;align-items:center;gap:10px;font-weight:800}
  .brand .dot{width:10px;height:10px;border-radius:50%;background:var(--acc-2);box-shadow:0 0 18px var(--acc-2)}
  .menu{display:flex;flex-wrap:wrap;gap:8px}
  .btn{
    border:1px solid var(--line);background:var(--bg-2);color:var(--text);
    border-radius:12px;padding:9px 14px;cursor:pointer;font-weight:700;letter-spacing:.2px;
  }
  .btn:hover{border-color:color-mix(in hsl, var(--acc) 45%, var(--line))}
  .btn-primary{background:var(--acc);border-color:var(--acc);color:#fff}
  .btn-primary:hover{filter:brightness(1.08)}
  .btn-ghost{background:transparent}
  .switch{display:flex;align-items:center;gap:8px}

  .filters, .block{
    background:var(--card);border:1px solid var(--line);
    border-radius:var(--radius);box-shadow:var(--shadow);padding:14px;
  }
  .filters{display:grid;grid-template-columns:1fr 1fr 1fr auto;gap:10px;align-items:center}
  select, input[type="text"]{
    width:100%;background:var(--bg-2);border:1px solid var(--line);color:var(--text);
    border-radius:12px;padding:10px 12px;outline:none;
  }

  .ads3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin:16px 0}
  .ad{
    position:relative;overflow:hidden;border-radius:18px;background:linear-gradient(180deg, color-mix(in hsl, var(--acc) 22%, transparent), color-mix(in hsl, var(--bg) 90%, transparent));
    border:1px solid var(--line);box-shadow:var(--shadow);
  }
  .ad img{display:block;width:100%;height:320px;object-fit:cover}
  .ad .tag{
    position:absolute;top:12px;left:12px;background:color-mix(in hsl, var(--bg) 70%, var(--acc) 30%);
    border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-size:12px;color:var(--text)
  }

  .partners{margin:18px 0}
  .partner{
    display:grid;grid-template-columns:72px 1fr auto;gap:12px;align-items:center;
    border:1px solid var(--line);background:var(--bg-2);border-radius:14px;padding:12px;box-shadow:var(--shadow)
  }
  .logo{
    width:72px;height:72px;border-radius:12px;display:grid;place-items:center;
    background:linear-gradient(140deg, color-mix(in hsl, var(--acc) 25%, transparent), color-mix(in hsl, var(--acc-2) 25%, transparent));
    border:1px solid var(--line)
  }
  .logo img{max-width:90%;max-height:90%}
  .meta small{color:var(--muted)}
  .chips{color:#fff;background:linear-gradient(90deg, var(--acc) 0%, #7aa8ff 100%);padding:3px 9px;border-radius:999px;font-size:12px}
  .row{display:flex;gap:8px;flex-wrap:wrap}
  .stars{color:#ffb400}
  .partners-grid{display:grid;gap:12px}
  .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--line);background:var(--bg-2);font-size:13px}
  .hr{height:1px;background:var(--line);margin:14px 0}

  .gallery3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
  .frame{
    border-radius:18px;border:1px solid var(--line);overflow:hidden;box-shadow:var(--shadow);
    background:radial-gradient(600px 200px at 50% -100px, color-mix(in hsl, var(--acc) 15%, transparent), transparent)
  }
  .frame img{display:block;width:100%;height:220px;object-fit:cover}

  .facts, .recipes{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
  .fact, .recipe{
    border:1px solid var(--line);border-radius:14px;background:var(--bg-2);padding:12px;box-shadow:var(--shadow)
  }
  .fact b{color:var(--acc)}
  .recipe img{width:100%;height:140px;object-fit:cover;border-radius:10px;margin-bottom:8px}

  .book{display:grid;gap:12px}
  .contact{
    display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;
    border:1px solid var(--line);border-radius:12px;background:var(--bg-2);padding:10px
  }
  .contact .t{font-weight:700}
  .contact .links a{margin-left:8px;color:var(--acc);text-decoration:none}

  /* –º–æ–¥–∞–ª–∫–∏ */
  .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,10,25,.6);backdrop-filter:blur(6px);z-index:50}
  .modal.show{display:grid}
  .box{width:min(720px,calc(100vw - 28px));max-height:80vh;overflow:auto;background:var(--card);
        border:1px solid var(--line);border-radius:18px;box-shadow:var(--shadow);padding:18px}
  textarea{width:100%;background:var(--bg-2);border:1px solid var(--line);color:var(--text);border-radius:12px;padding:10px}
  .stars-input .s{font-size:22px;cursor:pointer;color:#cbd5e1}
  .stars-input .s.on{color:#ffb400}
  .mt8{margin-top:8px}.mt12{margin-top:12px}.mt16{margin-top:16px}.mt20{margin-top:20px}

  footer{padding:32px 0;color:var(--muted);text-align:center}
  @media (max-width:900px){
    .filters{grid-template-columns:1fr 1fr;grid-auto-rows:auto}
    .ads3,.gallery3,.facts,.recipes{grid-template-columns:1fr}
    .partner{grid-template-columns:56px 1fr}
  }
</style>
</head>
<body data-theme="dark">
<header>
  <div class="wrap nav">
    <div class="brand"><span class="dot"></span><span>SiyaEm Korea</span></div>
    <div class="menu">
      <button class="btn-ghost btn" data-open="#about">–û –Ω–∞—Å</button>
      <button class="btn-ghost btn" data-open="#services">–£—Å–ª—É–≥–∏</button>
      <button class="btn btn-primary" data-open="#partnerForm">–°—Ç–∞—Ç—å –ø–∞—Ä—Ç–Ω—ë—Ä–æ–º</button>
      <div class="switch">
        <button id="guestBtn" class="btn">–ì–æ—Å—Ç—å</button>
        <button id="themeBtn" class="btn-ghost btn" title="–¢—ë–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è">üåì</button>
      </div>
    </div>
  </div>
</header>

<main class="wrap">
  <!-- –§–∏–ª—å—Ç—Ä—ã -->
  <section class="filters block">
    <select id="fProvince"></select>
    <select id="fCity"></select>
    <select id="fCategory"></select>
    <button id="applyFilters" class="btn btn-primary">–ü–æ–∫–∞–∑–∞—Ç—å</button>
    <div style="grid-column:1/-1;color:var(--muted);font-size:13px">
      –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—à–ª–∏ —Ä—É—á–Ω—É—é –º–æ–¥–µ—Ä–∞—Ü–∏—é –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª–∏ –ª–∏—Ü–µ–Ω–∑–∏—é.
    </div>
  </section>

  <!-- –†–µ–∫–ª–∞–º–Ω—ã–µ —Å–ª–æ—Ç—ã -->
  <section class="ads3">
    <article class="ad"><span class="tag">–†–µ–∫–ª–∞–º–∞ ‚Äî —Å–ª–æ—Ç #1</span>
      <img src="https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?q=80&w=1600&auto=format&fit=crop" alt="">
    </article>
    <article class="ad"><span class="tag">–†–µ–∫–ª–∞–º–∞ ‚Äî —Å–ª–æ—Ç #2</span>
      <img src="https://images.unsplash.com/photo-1512058564366-18510be2db19?q=80&w=1600&auto=format&fit=crop" alt="">
    </article>
    <article class="ad"><span class="tag">–†–µ–∫–ª–∞–º–∞ ‚Äî —Å–ª–æ—Ç #3</span>
      <img src="https://images.unsplash.com/photo-1511818966892-d7d671e672a2?q=80&w=1600&auto=format&fit=crop" alt="">
    </article>
  </section>

  <!-- –ü–∞—Ä—Ç–Ω—ë—Ä—ã -->
  <section class="partners block">
    <h3 style="margin:0 0 10px">–ü–∞—Ä—Ç–Ω—ë—Ä—ã (–º–æ–¥–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ)</h3>
    <div id="partnersList" class="partners-grid"></div>
  </section>

  <!-- –ì–∞–ª–µ—Ä–µ—è / –ø—Ä–æ–º–æ —Å–Ω–∏–∑—É -->
  <section class="block">
    <h3 style="margin:0 0 10px">–ü—Ä–æ–º–æ / –ì–∞–ª–µ—Ä–µ—è</h3>
    <div class="gallery3">
      <div class="frame"><img src="https://images.unsplash.com/photo-1541542684-4a66f7d9c163?q=80&w=1500&auto=format&fit=crop" alt=""></div>
      <div class="frame"><img src="https://images.unsplash.com/photo-1505577060968-6ce26a3a09e9?q=80&w=1500&auto=format&fit=crop" alt=""></div>
      <div class="frame"><img src="https://images.unsplash.com/photo-1512621776951-a57141f2eefd?q=80&w=1500&auto=format&fit=crop" alt=""></div>
    </div>
  </section>

  <!-- –§–∞–∫—Ç—ã -->
  <section class="block">
    <h3 style="margin:0 0 10px">–ê –≤—ã –∑–Ω–∞–ª–∏?</h3>
    <div id="facts" class="facts"></div>
  </section>

  <!-- –†–µ—Ü–µ–ø—Ç—ã -->
  <section class="block">
    <h3 style="margin:0 0 10px">–†–µ—Ü–µ–ø—Ç—ã</h3>
    <div id="recipes" class="recipes"></div>
  </section>

  <!-- –ó–∞–ø–∏—Å–Ω–∞—è –∫–Ω–∏–≥–∞ -->
  <section class="block">
    <h3 style="margin:0 0 10px">–ó–∞–ø–∏—Å–Ω–∞—è –∫–Ω–∏–≥–∞ (–∫–æ–Ω—Ç–∞–∫—Ç—ã –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤)</h3>
    <input id="bookSearch" type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é / –≥–æ—Ä–æ–¥—É / –∫–∞—Ç–µ–≥–æ—Ä–∏–∏‚Ä¶">
    <div id="book" class="book mt12"></div>
  </section>
</main>

<footer>¬© 2025 SiyaEm Korea. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</footer>

<!-- –ú–æ–¥–∞–ª–∫–∏ -->
<div class="modal" id="about"><div class="box">
  <h3>–û –Ω–∞—Å</h3>
  <p style="color:var(--muted)">–ú—ã —Å–æ–±–∏—Ä–∞–µ–º –∏ –ø—Ä–æ–¥–≤–∏–≥–∞–µ–º <b>—Ç–æ–ª—å–∫–æ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ</b> –∏ <b>–ª–µ–≥–∞–ª—å–Ω—ã–µ</b> –º–µ—Å—Ç–∞ –≤ –ö–æ—Ä–µ–µ. –ö–∞–∂–¥–∞—è —Ç–æ—á–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –ª–∏—Ü–µ–Ω–∑–∏–∏ –∏ –±–∞–∑–æ–≤—É—é –º–æ–¥–µ—Ä–∞—Ü–∏—é.</p>
  <div class="row mt12"><button class="btn btn-primary" data-close>–û–∫</button></div>
</div></div>

<div class="modal" id="services"><div class="box">
  <h3>–£—Å–ª—É–≥–∏</h3>
  <ul>
    <li>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Ü–µ–Ω–∑–∏–π –∏ –º–æ–¥–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤</li>
    <li>–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –Ω–∞ —Å–∞–π—Ç–µ –∏ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö</li>
    <li>–§–æ—Ç–æ—Å—ä—ë–º–∫–∞, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫, –∫–æ–Ω—Ç–µ–Ω—Ç</li>
  </ul>
  <div class="row mt12"><button class="btn btn-primary" data-close>–ü–æ–Ω—è—Ç–Ω–æ</button></div>
</div></div>

<div class="modal" id="partnerForm"><div class="box">
  <h3>–ê–Ω–∫–µ—Ç–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–∞</h3>
  <p class="mt8" style="color:var(--muted)">–£–ø—Ä–æ—Å—Ç–∏–ª —Ñ–æ—Ä–º—É ‚Äî –ø–æ–∑–∂–µ –ø–æ–¥–∫–ª—é—á–∏–º Google Forms/Sheets. –°–µ–π—á–∞—Å ‚Äî –¥–µ–º–æ.</p>
  <div class="row mt12">
    <input type="text" id="pfTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è *">
    <input type="text" id="pfOwner" placeholder="–§–ò–û –≤–ª–∞–¥–µ–ª—å—Ü–∞ *">
    <input type="text" id="pfPhone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω *">
    <input type="text" id="pfAddress" placeholder="–ê–¥—Ä–µ—Å (–∫–∞–∫ –≤ –ª–∏—Ü–µ–Ω–∑–∏–∏) *">
  </div>
  <div class="row mt12">
    <select id="pfProvince"></select>
    <input type="text" id="pfCity" placeholder="–ì–æ—Ä–æ–¥ *">
  </div>
  <div class="row mt12">
    <select id="pfCategory"></select>
    <input type="text" id="pfSubcats" placeholder="–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)">
  </div>
  <textarea id="pfDesc" class="mt12" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ / –∏—Å—Ç–æ—Ä–∏—è (–ø–æ –∂–µ–ª–∞–Ω–∏—é)"></textarea>
  <div class="row mt16">
    <button id="pfSend" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    <button class="btn" data-close>–û—Ç–º–µ–Ω–∞</button>
  </div>
  <div id="pfResult" class="mt12" style="display:none;color:var(--good)"><b>–ì–æ—Ç–æ–≤–æ!</b> –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é (10‚Äì60 –º–∏–Ω—É—Ç).</div>
</div></div>

<div class="modal" id="reviewModal"><div class="box">
  <h3>–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h3>
  <div id="revFor" style="color:var(--muted)"></div>
  <div class="stars-input mt12" id="revStars"></div>
  <textarea id="revText" class="mt12" placeholder="–í–∞—à –æ—Ç–∑—ã–≤‚Ä¶"></textarea>
  <div class="row mt16">
    <button id="revSend" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    <button class="btn" data-close>–û—Ç–º–µ–Ω–∞</button>
  </div>
  <div id="revDone" class="mt12" style="display:none;color:var(--good)">–°–ø–∞—Å–∏–±–æ! –û—Ç–∑—ã–≤ —É—á—Ç—ë–Ω.</div>
</div></div>

<div class="modal" id="guest"><div class="box">
  <h3>–í–æ–π—Ç–∏ –∫–∞–∫ –≥–æ—Å—Ç—å</h3>
  <div class="row mt12">
    <input type="text" id="gName" placeholder="–í–∞—à–µ –∏–º—è *">
    <input type="text" id="gEmail" placeholder="Email *">
  </div>
  <div class="row mt16">
    <button id="gSave" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button class="btn" data-close>–û—Ç–º–µ–Ω–∞</button>
  </div>
  <div id="gOk" class="mt12" style="display:none;color:var(--good)">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.</div>
</div></div>

<script>
/* ===========================
   –î–ê–ù–ù–´–ï (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ fetch)
   =========================== */
const DATA = {
  provinces: ["–ß—Ö—É–Ω—á—Ö–æ–Ω–Ω–∞–º-–¥–æ","–°–µ—É–ª","–ö—ë–Ω–≥–∏-–¥–æ","–ü—É—Å–∞–Ω"],
  categories: ["–ï–¥–∞","–°–∞–ª–æ–Ω—ã","–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å","–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è","–£—Å–ª—É–≥–∏"],
  partners: [
    {
      id:"mr_cook",
      name:"–ú–∏—Å—Ç–µ—Ä –ö—É–∫ (Mr. Cook)",
      category:"–ï–¥–∞",
      subcategories:["–ö–æ—Ä–µ–π—Å–∫–∞—è –∫—É—Ö–Ω—è","–°—Ç–æ–ª–æ–≤–∞—è"],
      rating:4.6,
      reviews:1,
      province_ru:"–ß—Ö—É–Ω—á—Ö–æ–Ω–Ω–∞–º-–¥–æ",
      city_ru:"–ê—Å–∞–Ω-—Å–∏, –î–æ–Ω–ø–æ-–º—ë–Ω",
      address:"405-20 Dunpo-ri, Dunpo-myeon, Asan-si, Chungcheongnam-do",
      lat:36.9305, lng:127.0458,
      phone:"+82-10-9809-1703",
      site:"",
      instagram:"",
      logo:"https://raw.githubusercontent.com/kandrphkorea-cmd/siyaem-site2/main/mr-cook-logo.png" /* –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø–æ—Å—Ç–∞–≤–∏–º —ç–º–æ–¥–∑–∏ */
    }
  ],
  facts: [
    {t:"–°–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—ë—Ç –∫—É—Ä–∏—Ü—ã ‚Äî **13 —Å–µ–∫—É–Ω–¥** –∏ –æ–∫–æ–ª–æ **100 –º–µ—Ç—Ä–æ–≤**."},
    {t:"–õ–∞–ø—à–∞ **—Ä–∞–º—ë–Ω** –ø–æ—è–≤–∏–ª–∞—Å—å –≤ –ö–æ—Ä–µ–µ –≤ 1963 –≥–æ–¥—É ‚Äî –∫–∞–∫ –¥–æ—Å—Ç—É–ø–Ω–∞—è –µ–¥–∞ –≤ —Ç—è–∂—ë–ª—ã–µ –≤—Ä–µ–º–µ–Ω–∞."},
    {t:"–ü–µ—Ä–µ—Ü —á–∏–ª–∏ –ø–æ–ø–∞–ª –≤ –ö–æ—Ä–µ—é –≤ XVI –≤–µ–∫–µ –∏ –Ω–∞–≤—Å–µ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª –≤–∫—É—Å –∫–∏–º—á–∏."},
  ],
  recipes: [
    {title:"–ü–∏–±–∏–º–±–∞–ø ‚Äî –±—ã—Å—Ç—Ä—ã–π", img:"https://images.unsplash.com/photo-1553621042-f6e147245754?q=80&w=1400&auto=format&fit=crop", short:"–†–∏—Å, –æ–≤–æ—â–∏, —è–π—Ü–æ, –≥–æ—á—É–¥–∂–∞–Ω. –í—Å—ë —Å–º–µ—à–∞—Ç—å ‚Äî –≥–æ—Ç–æ–≤–æ."},
    {title:"–ö–∏–º—á–∏-–±–æ–∫–µ-–ø–∞–±", img:"https://images.unsplash.com/photo-1544025162-d76694265947?q=80&w=1400&auto=format&fit=crop", short:"–ñ–∞—Ä–µ–Ω—ã–π —Ä–∏—Å —Å –∫–∏–º—á–∏ –∏ –±–µ–∫–æ–Ω–æ–º ‚Äî 10 –º–∏–Ω—É—Ç."},
    {title:"–¢—Ç–æ–∫–ø–æ–∫–∫–∏", img:"https://images.unsplash.com/photo-1572610299316-ffad036dfe1d?q=80&w=1400&auto=format&fit=crop", short:"–†–∏—Å–æ–≤—ã–µ –ø–∞–ª–æ—á–∫–∏ –≤ —Å–ª–∞–¥–∫–æ-–æ—Å—Ç—Ä–æ–º —Å–æ—É—Å–µ."}
  ]
};

/* ===========================
   –¢–ï–ú–ê
   =========================== */
const themeBtn = document.getElementById('themeBtn');
function setTheme(t){ document.body.setAttribute('data-theme', t); localStorage.setItem('theme', t); }
setTheme(localStorage.getItem('theme') || 'dark');
themeBtn.onclick = ()=> setTheme(document.body.getAttribute('data-theme')==='dark'?'light':'dark');

/* ===========================
   –ú–û–î–ê–õ–ö–ò
   =========================== */
document.querySelectorAll('[data-open]').forEach(b=>b.addEventListener('click',()=>document.querySelector(b.getAttribute('data-open')).classList.add('show')));
document.querySelectorAll('[data-close]').forEach(b=>b.addEventListener('click',()=>b.closest('.modal').classList.remove('show')));
document.querySelectorAll('.modal').forEach(m=>m.addEventListener('click',e=>{if(e.target===m)m.classList.remove('show')}));

/* ===========================
   –§–ò–õ–¨–¢–†–´
   =========================== */
const fp = document.getElementById('fProvince');
const fc = document.getElementById('fCity');
const fcat = document.getElementById('fCategory');
fp.innerHTML = `<option value="">–ü—Ä–æ–≤–∏–Ω—Ü–∏—è: –≤—Å–µ</option>` + DATA.provinces.map(x=>`<option>${x}</option>`).join('');
fc.innerHTML = `<option value="">–ì–æ—Ä–æ–¥: –≤—Å–µ</option>` + [...new Set(DATA.partners.map(x=>x.city_ru))].map(x=>`<option>${x}</option>`).join('');
fcat.innerHTML = `<option value="">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –≤—Å–µ</option>` + DATA.categories.map(x=>`<option>${x}</option>`).join('');

/* ===========================
   –†–ï–ù–î–ï–† –ü–ê–†–¢–ù–Å–†–û–í
   =========================== */
const partnersList = document.getElementById('partnersList');
function starHTML(v){ // —Ç–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
  const full = Math.round(v*2)/2;
  let s = '';
  for(let i=1;i<=5;i++){
    const diff = full - i;
    if(diff>=0) s+='‚òÖ'; else if(diff===-0.5) s+='‚òÜ'; else s+='‚òÜ';
  }
  return `<span class="stars" title="${v.toFixed(1)}">${s}</span><small> (${getStoreReviews().[currentId(v)]?.len||1})</small>`;
}
function currentId(v){return 'mr_cook'} // —Ç—É—Ç –æ–¥–∏–Ω –ø–∞—Ä—Ç–Ω—ë—Ä ‚Äî –æ—Å—Ç–∞–≤–∏–ª –∑–∞–≥–ª—É—à–∫—É, –µ—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–∏—à—å ‚Äî –ø–æ–¥—Å—Ç–∞–≤–ª—è–π id
function makePartnerCard(p){
  const logo = p.logo ? `<img alt="logo" src="${p.logo}" />` : 'üç≤';
  const rating = getStoreReviews()[p.id]?.avg ?? p.rating;
  const reviewsLen = getStoreReviews()[p.id]?.len ?? p.reviews;
  return `
  <article class="partner">
    <div class="logo">${logo}</div>
    <div class="meta">
      <div class="row" style="align-items:center;gap:10px">
        <strong>${p.name}</strong> <span class="chips">${p.category}${p.subcategories?.length?` ‚Äî ${p.subcategories.join(', ')}`:''}</span>
      </div>
      <small>${p.province_ru} ‚Ä¢ ${p.city_ru}</small><br>
      <small>${p.address}</small><br>
      <div class="row mt8"><span class="stars" title="—Ä–µ–π—Ç–∏–Ω–≥">${'‚òÖ'.repeat(Math.round(rating))}${'‚òÜ'.repeat(5-Math.round(rating))}</span>
        <small>(${reviewsLen})</small>
      </div>
    </div>
    <div class="row">
      <button class="btn" data-review="${p.id}">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
      <button class="btn" data-map="${p.id}">–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
    </div>
  </article>`;
}
function renderPartners(){
  const filtered = DATA.partners.filter(p=>
     (!fp.value || p.province_ru===fp.value) &&
     (!fc.value || p.city_ru===fc.value) &&
     (!fcat.value || p.category===fcat.value)
  );
  partnersList.innerHTML = filtered.map(makePartnerCard).join('') || `<div class="pill">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üôà –ò–∑–º–µ–Ω–∏ —Ñ–∏–ª—å—Ç—Ä—ã.</div>`;
  // –∫–Ω–æ–ø–∫–∏
  partnersList.querySelectorAll('[data-map]').forEach(b=>{
    b.onclick = ()=>{
      const p = DATA.partners.find(x=>x.id===b.dataset.map);
      const q = p.lat && p.lng ? `${p.lat},${p.lng}` : encodeURIComponent(p.address);
      window.open(`https://www.google.com/maps?q=${q}`,'_blank');
    };
  });
  partnersList.querySelectorAll('[data-review]').forEach(b=>{
    b.onclick = ()=> openReview(b.dataset.review);
  });
}
document.getElementById('applyFilters').onclick = renderPartners;

/* ===========================
   ¬´–ê –≤—ã –∑–Ω–∞–ª–∏?¬ª –∏ ¬´–†–µ—Ü–µ–ø—Ç—ã¬ª
   =========================== */
document.getElementById('facts').innerHTML = DATA.facts.map(x=>`<div class="fact"><b>–§–∞–∫—Ç:</b> ${x.t}</div>`).join('');
document.getElementById('recipes').innerHTML = DATA.recipes.map(x=>`
  <article class="recipe">
    <img src="${x.img}" alt="">
    <strong>${x.title}</strong>
    <div class="mt8" style="color:var(--muted)">${x.short}</div>
  </article>`).join('');

/* ===========================
   –ó–ê–ü–ò–°–ù–ê–Ø –ö–ù–ò–ì–ê
   =========================== */
const book = document.getElementById('book');
const bookSearch = document.getElementById('bookSearch');
function renderBook(){
  const q=(bookSearch.value||'').trim().toLowerCase();
  const items = DATA.partners.filter(p=>{
    const hay=[p.name,p.city_ru,p.province_ru,p.category,(p.subcategories||[]).join(' ')].join(' ').toLowerCase();
    return hay.includes(q);
  });
  book.innerHTML = items.map(p=>`
    <div class="contact">
      <div>
        <div class="t">${p.name}</div>
        <div style="color:var(--muted);font-size:13px">${p.category}${p.subcategories?.length?` ‚Äî ${p.subcategories.join(', ')}`:''} ‚Ä¢ ${p.city_ru}</div>
      </div>
      <div class="links">
        ${p.phone?`<a href="tel:${p.phone}">üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å</a>`:''}
        ${p.site?`<a href="${p.site}" target="_blank">üåê –°–∞–π—Ç</a>`:''}
        ${p.instagram?`<a href="${p.instagram}" target="_blank">üì∑ Instagram</a>`:''}
      </div>
    </div>
  `).join('');
}
bookSearch.oninput = renderBook;

/* ===========================
   –û–¢–ó–´–í–´/–†–ï–ô–¢–ò–ù–ì (localStorage)
   =========================== */
const LS_KEY = 'siyaem_reviews_v1';
function getStoreReviews(){ try { return JSON.parse(localStorage.getItem(LS_KEY))||{} } catch(_){ return {} } }
function setStoreReviews(obj){ localStorage.setItem(LS_KEY, JSON.stringify(obj)) }

let currentReviewId = null;
const revModal = document.getElementById('reviewModal');
const revFor = document.getElementById('revFor');
const revStars = document.getElementById('revStars');
const revText = document.getElementById('revText');
const revDone = document.getElementById('revDone');
function openReview(id){
  currentReviewId = id;
  revFor.innerHTML = `–î–ª—è: <b>${DATA.partners.find(p=>p.id===id).name}</b>`;
  // –∑–≤—ë–∑–¥—ã
  revStars.innerHTML = Array.from({length:5},(_,i)=>`<span class="s" data-v="${i+1}">‚òÖ</span>`).join('');
  let cur = 0;
  revStars.querySelectorAll('.s').forEach(s=>{
    s.onclick = ()=>{ cur = +s.dataset.v; setOn(); };
    s.onmouseenter = ()=>{ setOn(+s.dataset.v) };
    s.onmouseleave = ()=>{ setOn(cur) };
  });
  function setOn(k=cur){ revStars.querySelectorAll('.s').forEach((x,i)=>x.classList.toggle('on', i<k)); }
  revText.value = '';
  revDone.style.display='none';
  revModal.classList.add('show');
  document.getElementById('revSend').onclick = ()=>{
    const stars = cur || 5;
    const text = (revText.value||'').trim();
    const base = getStoreReviews();
    const old = base[id] || {avg: DATA.partners.find(p=>p.id===id).rating, len: DATA.partners.find(p=>p.id===id).reviews};
    const sum = old.avg*old.len + stars;
    const len = old.len + 1;
    base[id] = {avg: sum/len, len, last:text};
    setStoreReviews(base);
    revDone.style.display='block';
    setTimeout(()=>{ revModal.classList.remove('show'); renderPartners(); renderBook(); }, 700);
  };
}

/* ===========================
   –ì–û–°–¢–¨ (localStorage)
   =========================== */
document.getElementById('guestBtn').onclick = ()=>document.getElementById('guest').classList.add('show');
document.getElementById('gSave').onclick = ()=>{
  const n = (document.getElementById('gName').value||'').trim();
  const e = (document.getElementById('gEmail').value||'').trim();
  if(!n||!e){ alert('–ó–∞–ø–æ–ª–Ω–∏ –∏–º—è –∏ email.'); return; }
  localStorage.setItem('siyaem_guest', JSON.stringify({n,e,ts:Date.now()}));
  document.getElementById('gOk').style.display='block';
  setTimeout(()=>document.getElementById('guest').classList.remove('show'), 800);
};

/* ===========================
   –ê–ù–ö–ï–¢–ê –ü–ê–†–¢–ù–Å–†–ê (–¥–µ–º–æ)
   =========================== */
const pfProvince = document.getElementById('pfProvince');
const pfCategory = document.getElementById('pfCategory');
pfProvince.innerHTML = DATA.provinces.map(x=>`<option>${x}</option>`).join('');
pfCategory.innerHTML = DATA.categories.map(x=>`<option>${x}</option>`).join('');
document.getElementById('pfSend').onclick = ()=>{
  document.getElementById('pfResult').style.display='block';
  setTimeout(()=>document.getElementById('partnerForm').classList.remove('show'),1000);
};

/* ===========================
   INIT
   =========================== */
renderPartners();
renderBook();
</script>
</body>
</html>
